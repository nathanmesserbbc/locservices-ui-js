define(["jquery","locservices/ui/component/component"],function(a,b){"use strict";function c(b){var c=this;if(b=b||{},b.componentId="search_results",void 0===b.api)throw new Error("SearchResults requires api parameter");c.api=b.api,c.setComponentOptions(b),a.on(this.eventNamespaceBase+":component:search:results",function(a,b){if(1===b.totalResults){var d=a[0];return void c.emit("location",[d])}c.render(a,b)}),a.on(c.eventNamespaceBase+":component:search:clear",function(){c.clear()}),a.on(c.eventNamespaceBase+":component:search:start",function(){c.clear()}),c._data={},c.setup()}return c.prototype=new b,c.prototype.constructor=c,c.prototype.setup=function(){this.element=a("<div />").addClass("ls-ui-comp-search_results"),this.list=a("<ul />"),this.moreResults=a("<button />").addClass("ls-ui-comp-search_results-more").text(this.translations.get("search_results.more")),this.element.append(this.list).append(this.moreResults),this.container.append(this.element);var b=this;this.list.on("click",function(c){var d,e,f;return c.preventDefault(),e=a(c.target).data("id"),f=a(c.target).data("offset"),d=b._data[e],b.clear(),b.emit("location",[d,f]),!1});var c=!1;this.moreResults.on("click",function(a){return a.preventDefault(),c!==!0?(c=!0,b.api.search(b.searchTerm,{start:b.offset+10,success:function(a){b.render(a.results,a.metadata),c=!1}}),!1):void 0})},c.prototype.render=function(a,b){var c,d,e,f,g,h="";if(e=a.length,c=this,this.offset=b.start||0,this.searchTerm=b.search,0===e)this.element.removeClass("ls-ui-comp-search_results-with_results");else{for(this.element.addClass("ls-ui-comp-search_results-with_results"),d=0;e>d;d++)f=a[d],this._data[f.id]=f,g=f.name,f.container&&(g+=", "+f.container),h+='<li><a href="" data-id="'+f.id+'" data-offset="'+this.offset+'">'+g+"</a></li>";0===this.offset?this.list.html(h):this.list.append(h),b.totalResults>10&&this.offset+10<b.totalResults?this.moreResults.addClass("ls-ui-comp-search_results-active"):this.moreResults.removeClass("ls-ui-comp-search_results-active"),this.list.find("li:nth-child("+(c.offset+1)+") a").focus()}this.emit("results",{searchTerm:this.searchTerm,offset:this.offset,totalResults:b.totalResults})},c.prototype.clear=function(){this.moreResults.removeClass("ls-ui-comp-search_results-active"),this.element.removeClass("ls-ui-comp-search_results-with_results"),this.list.empty(),this._data={}},c});