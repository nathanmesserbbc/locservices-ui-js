define(["jquery","locservices/ui/component/component"],function(a,b){"use strict";function c(b){var c,d=this;if(b=b||{},b.componentId="search",void 0===b.api)throw new Error("Search requires api parameter");d.api=b.api,d.setComponentOptions(b),d.isSearching=!1,d.hasAValidSearchTerm=!1,d.locationName=b.locationName,c="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,i(d.translations,d.container,c),d.input=d.container.find("input[type=text]").on("keyup",function(){d.checkInput()}),"string"==typeof d.locationName&&d.input.val(d.locationName),c&&(this.hasClearControl=!0,d.container.find(".ls-ui-input-clear").on("click",function(){d.clear()})),d.form=d.container.find("form"),d.form.on("submit",function(a){a.preventDefault(),d.search(d.input.val())}),d.input.on("focus",function(){d.input.val()===d.locationName&&d.input.val(""),d.emit("focus")}),d.container.find("input[type=submit]").on("click",function(){d.form.trigger("submit")}),a.on(d.eventNamespaceBase+":controller:inactive",function(){void 0!==d.locationName&&d.input.val(d.locationName)})}var d=function(){return a("<div />").addClass("ls-ui-container")},e=function(){return a("<form />").attr("method","post").attr("action","#").addClass("ls-ui-form").addClass("ls-ui-comp-search")},f=function(b){return a("<input />").attr("type","text").attr("class","ls-ui-input").attr("placeholder",b.get("search.placeholder"))},g=function(b){return a("<button />").attr("class","ls-ui-input-clear").text(b.get("search.clear"))},h=function(b){return a("<input />").attr("type","submit").attr("class","ls-ui-submit").attr("value",b.get("search.submit")).attr("title",b.get("search.submit.title"))};c.prototype=new b,c.prototype.constructor=c,c.prototype.clear=function(){this.input.val(""),this.hasAValidSearchTerm=!1,this.form.removeClass("ls-ui-comp-search-with-term"),this.hasClearControl&&this.form.removeClass("ls-ui-comp-search-with-clear"),this.emit("clear")},c.prototype.checkInput=function(){var a=this.input.val();0<a.length?!1===this.hasAValidSearchTerm&&(this.hasAValidSearchTerm=!0,this.form.addClass("ls-ui-comp-search-with-term"),this.hasClearControl&&this.form.addClass("ls-ui-comp-search-with-clear")):this.hasAValidSearchTerm&&this.clear()},c.prototype.search=function(a){var b=this;a=(a||"").replace(/^\s+|\s+$/g,""),a&&!0!==b.isSearching&&(b.emit("start",[a]),b.isSearching=!0,b.api.search(a,{success:function(a){b.emit("end"),b.isSearching=!1,b.emit("results",[a.results,a.metadata])},error:function(){b.emit("end"),b.isSearching=!1,b.emit("error",[{code:"search.error.search",message:"There was an API error searching for "+a}])}}))};var i=function(a,b,c){var i;i=e().append(d().append(f(a))).append(h(a)),c&&i.append(g(a)),b.append(i)};return c});